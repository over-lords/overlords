<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover">
  <link href='https://fonts.googleapis.com/css?family=Racing Sans One' rel='stylesheet'>
  <link rel="icon" href="https://raw.githubusercontent.com/over-lords/overlords/4c614c1ffe5a9d7194202bd24fae5e7c99d86333/Public/Images/Site%20Assets/favicon.png" type="image/png">
  <link rel="stylesheet" href="style.css">
  <title>Overlords</title>
  <style>
    .deck-container {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 18px;
      margin: 200px 50px 50px 50px;
      padding: 20px; /* add some padding inside the box */
      padding-left: 40px;
      padding-bottom: 50px;

      background-color: rgba(51, 51, 51, 0.85);      /* dark gray background */
      border: 2px solid black;     /* black border */
      border-radius: 8px;          /* optional: rounded corners */
    }
    .deck-row {
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 14px;
    }
    .deck-qty {
      flex-shrink: 0;               
      text-align: center;
      font-weight: bold;
      font-family: 'Racing Sans One', sans-serif;
      font-size: 72px;
      line-height: 1;
      color: black;
      padding: 10px 14px;

      background-color: rgba(255, 255, 255, 0.7); 
      border: 4px solid black;
      border-radius: 6px;           
      box-sizing: border-box;

      width: 120px; /* fixed width wide enough for largest qty */
      margin-right: 14px;
    }
  </style>
</head>
<body style="background-color:white;" onload="window.scrollTo(0, 1)">
  <div class="bg-image" alt="" style="opacity: 55%;"></div>
    <div class="title-box" id="title-box"></div>
    <h1 class="glow-red" style="pointer-events: none;">Overlords</h1>

  <div class="deckTitle-box" id="deckTitle-box" style="pointer-events: none;">
    <h1 id="hero-title" class="glow-dynamic" style="pointer-events: none;"></h1>
  </div>

  <div class="close-box" id="close-box" onclick="location.href='deckList.html'" style="cursor: pointer; margin-top: -120px; background-color: red;">
    <h1 class="menu-text" style="margin-top: 2.5px; pointer-events: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X</h1>
  </div>

  <script type="module">
    import { renderCard } from './utils/cardRenderer.js';
    import { heroCards } from './data/heroCards.js';
    import { heroes } from './data/faceCards.js';

    window.addEventListener('DOMContentLoaded', () => {
      const urlParams = new URLSearchParams(window.location.search);
      const heroName = urlParams.get('name');

      // === Get DOM elements ===
      const titleEl = document.getElementById('hero-title');

      // === Find hero data ===
      const heroData = heroes.find(h => h.name === heroName);
      const teamFolder = "https://raw.githubusercontent.com/over-lords/overlords/4bb2b39a79b5b0b717ddd5fc62821adb7d7c9cd6/Public/Images/Card%20Assets/Misc";

      // === Update title and hero name dynamically ===
      if (heroData) {
        if (titleEl) {
          titleEl.textContent = heroData.name;
          titleEl.style.color = heroData.color;
          titleEl.style.textShadow = `0 0 4px black, 0 0 6px white, 0 0 8px black`;
          titleEl.style.fontSize = "32px";
          titleEl.style.fontFamily = "'Racing Sans One', sans-serif";
        }
      } else {
        if (titleEl) {
          titleEl.textContent = heroName || 'Unknown Hero';
          titleEl.style.color = 'black';
          titleEl.style.textShadow = 'none';
        }
      }

      // === Hero Info Box ===
      if (heroData) {
        const infoBox = document.createElement('div');
        infoBox.style.position = 'absolute';
        infoBox.style.top = '15px';
        infoBox.style.right = '20px';
        infoBox.style.width = '300px';
        infoBox.style.background = 'rgba(255,255,255,0.8)';
        infoBox.style.border = '2px solid black';
        infoBox.style.borderRadius = '8px';
        infoBox.style.padding = '8px';
        infoBox.style.fontFamily = "'Racing Sans One', sans-serif";
        infoBox.style.fontSize = '16px';
        infoBox.style.color = 'black';
        infoBox.style.boxShadow = '2px 3px 8px rgba(0,0,0,0.3)';

        // Teams row
        const teamDiv = document.createElement('div');
        teamDiv.style.display = 'flex';
        teamDiv.style.alignItems = 'center';
        const teamLabel = document.createElement('span');
        teamLabel.textContent = 'Teams: ';
        teamLabel.style.fontWeight = 'bold';
        teamDiv.appendChild(teamLabel);
        heroData.teams.forEach(t => {
          const img = document.createElement('img');
          img.src = `${teamFolder}/${t}.png`;
          img.style.width = '28px';
          img.style.height = 'auto';
          img.style.marginLeft = '5px';
          teamDiv.appendChild(img);
        });
        infoBox.appendChild(teamDiv);

        // Stats
        const makeStat = (label, value) => {
          const el = document.createElement('div');
          el.innerHTML = `<span style="font-weight:bold">${label}:</span> ${value}`;
          return el;
        };
        infoBox.appendChild(makeStat('HP', heroData.hp));
        infoBox.appendChild(makeStat('Damage Threshold', heroData.damageThreshold));
        infoBox.appendChild(makeStat('Travel Budget', heroData.travel));
        infoBox.appendChild(makeStat('Retreat Requirement', heroData.retreat));

        // Abilities
        const abilities = document.createElement('div');
        abilities.style.marginTop = '12px';
        const abilitiesLabel = document.createElement('span');
        abilitiesLabel.textContent = 'Abilities: ';
        abilitiesLabel.style.fontWeight = 'bold';
        abilities.appendChild(abilitiesLabel);
        const abilitiesContent = document.createElement('span');
        abilitiesContent.innerHTML = heroData.abilitiesText
          ? heroData.abilitiesText.map(a => a.text).join('<br>')
          : 'None';
        abilitiesContent.style.display = 'inline-block';
        abilitiesContent.style.marginLeft = '0.25em';
        abilities.appendChild(abilitiesContent);
        infoBox.appendChild(abilities);

        document.body.appendChild(infoBox);
      }

      // === Create deck container ===
      const container = document.createElement('div');
      container.classList.add('deck-container');
      document.body.appendChild(container);

      // === Filter all cards for this hero ===
      const heroDeck = heroCards.filter(c => c.hero === heroName);
      if (heroDeck.length === 0) {
        const none = document.createElement('div');
        none.textContent = 'No cards found for this hero.';
        none.style.fontWeight = 'bold';
        none.style.color = 'black';
        none.style.fontSize = '36px';
        container.appendChild(none);
        return;
      }

      // === Render each card with its perDeck quantity ===
      heroDeck.forEach(cardData => {
        const row = document.createElement('div');
        row.classList.add('deck-row');

        const qty = document.createElement('div');
        qty.classList.add('deck-qty');
        qty.textContent = `${cardData.perDeck}x`;

        const cardElement = renderCard(cardData.id);
        row.appendChild(qty);
        row.appendChild(cardElement);

        container.appendChild(row);
      });
    });
    </script>

</body>
</html>